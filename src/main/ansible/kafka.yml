---
# Copyright (c) 2014 fStream. All Rights Reserved.
#
# fStream - Master playbook 
#
# Description: 
#   The is the master Ansible playbook file for provisioning the fStream system.
#
# See:
#   - http://www.ansibleworks.com/docs/playbooks.html

# This single play playbook will provision the VM
- hosts: kafka
  gather_facts: True
  sudo: yes
  vars:
    kafka_zookeeper_servers: "{{ hostvars | group_ips(groups, 'zookeeper') }}"    
    
  # Apply kafka role
  # TODO: Allow for multiple zookeepers
  roles: 
    - { role: kafka, kafka_host_name: "{{ ansible_default_ipv4.address }}", kafka_server_zookeeper_hosts: "{{ kafka_zookeeper_servers }}" }
